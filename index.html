<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The World Games Show</title>
  <meta name="description" content="Join our Zoom-based party game. Register fast, pay securely, and compete to win the prize pot!" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji'; }
    .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,.7); }
    .input { @apply w-full rounded-xl border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-indigo-500; }
    .label { @apply text-sm font-semibold text-gray-700; }
    .availability-item { background: #e0e7ff; padding: 0.5rem 1rem; border-radius: 0.5rem; margin-top: 0.5rem; }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-sky-50 text-gray-900">
  <!-- ... Header, Hero, How it works ... keep as is -->

  <!-- Registration -->
  <section id="register" class="py-12 bg-white">
    <div class="max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-10 items-start">
      <div>
        <h2 class="text-3xl font-extrabold">Quick Registration</h2>
        <p class="text-gray-700 mt-2">Fill this in first. If you already paid before, use the same email so we can match your payment automatically.</p>
        <form id="regForm" class="mt-6 grid grid-cols-1 gap-4" action="https://formspree.io/f/xjkojplo" method="POST" novalidate>
          <div>
            <label class="label" for="name">Full name</label>
            <input id="name" name="name" required class="input" />
          </div>
          <div>
            <label class="label" for="email">Email</label>
            <input id="email" name="email" type="email" required class="input" />
          </div>
          <div>
            <label class="label" for="phone">Phone</label>
            <input id="phone" name="phone" type="tel" inputmode="tel" pattern="[+0-9\-() ]+" placeholder="+1 647 555 0123" class="input" />
          </div>
          <div>
            <label class="label" for="hobbies">Hobbies</label>
            <input id="hobbies" name="hobbies" class="input" placeholder="Board games, quizzes, music…" />
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label class="label" for="city">City</label>
              <input id="city" name="city" required class="input" />
            </div>
            <div>
              <label class="label" for="country">Country</label>
              <input id="country" name="country" required class="input" />
            </div>
          </div>

          <div>
            <label class="label" for="dob">Date of Birth</label>
            <input id="dob" name="dob" type="date" required class="input" />
          </div>

          <div class="flex items-center gap-3 mt-1">
            <input id="consent" name="consent" type="checkbox" required class="h-4 w-4" />
            <label for="consent" class="text-sm text-gray-700">I agree to receive the Zoom link & updates for this event.</label>
          </div>

          <div class="flex items-center gap-3 mt-1">
            <input id="over18" name="over18" type="checkbox" required class="h-4 w-4" />
            <label for="over18" class="text-sm text-gray-700">I confirm that I am over 18 years old.</label>
          </div>

          <div class="flex items-center gap-3 mt-1">
            <input id="canadianResident" name="canadianResident" type="checkbox" required class="h-4 w-4" />
            <label for="canadianResident" class="text-sm text-gray-700">I confirm that I am a Canadian resident.</label>
          </div>

          <div class="flex items-center gap-3 mt-1">
            <input id="englishProficient" name="englishProficient" type="checkbox" required class="h-4 w-4" />
            <label for="englishProficient" class="text-sm text-gray-700">I confirm that I can speak and understand English.</label>
          </div>

          <div class="flex items-center gap-3 mt-1">
            <input id="videoConsent" name="videoConsent" type="checkbox" required class="h-4 w-4" />
            <label for="videoConsent" class="text-sm text-gray-700">I consent to my video being uploaded to social media.</label>
          </div>

          <h3 style="margin-top:20px;">Availability</h3>
          <p>Select one or both dates you are available:</p>
      
          <label for="dateSelect" class="label">Choose Date:</label>
          <select id="dateSelect" class="input" aria-label="Choose availability date">
            <option value="">-- Select Date --</option>
            <option value="2025-08-15">Friday, August 15, 2025 (10-12 PM)</option>
            <option value="2025-08-16">Saturday, August 16, 2025 (1-3 PM)</option>
          </select>
      
          <button type="button" id="addAvailabilityBtn" class="mt-2 bg-indigo-600 text-white px-5 py-3 rounded-xl hover:bg-indigo-700">Add Date & Time</button>
      
          <div class="availability-list" id="availabilityList" aria-live="polite" role="list"></div>

          <!-- Update the submit button to start disabled -->
          <button id="submitBtn" disabled class="mt-6 bg-gray-400 text-white px-5 py-3 rounded-xl cursor-not-allowed" type="submit">Submit Registration</button>
          <p class="text-xs text-gray-500 mt-2">Your info is used only for this event. No spam.</p>
        </form>
      </div>

      <!-- Payment Section (Hidden initially) -->
      <div id="pay" class="glass rounded-2xl p-6 shadow sticky top-24 mt-6" style="display:none;">
        <h3 class="text-2xl font-bold">Pay Entry Fee</h3>
        <p class="text-gray-700 mt-2">Secure payment is handled by Stripe on their hosted checkout page.</p>
        <ul class="mt-3 text-sm text-gray-700 list-disc list-inside">
          <li>Total due: <strong>$XX.XX</strong></li>
          <li>Use the <strong>same email</strong> you registered with.</li>
          <li>Non-refundable if you miss the start time.</li>
        </ul>
        <a href="https://buy.stripe.com/YOUR_PAYMENT_LINK" class="mt-5 inline-flex items-center justify-center w-full bg-indigo-600 text-white px-5 py-3 rounded-xl shadow hover:bg-indigo-700" target="_blank" rel="noopener noreferrer">Pay Now</a>
        <p class="text-xs text-gray-500 mt-2">After payment, you’ll be redirected to a confirmation page and receive the Zoom link by email.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="border-t">
    <div class="max-w-6xl mx-auto px-4 py-10 text-sm text-gray-600 flex flex-col md:flex-row gap-3 md:items-center md:justify-between">
      <p>© <span id="year"></span> The World Games Show. All rights reserved.</p>
      <div class="flex gap-4">
        <a href="#" class="hover:text-gray-900">Terms</a>
        <a href="#" class="hover:text-gray-900">Privacy</a>
        <a href="#" class="hover:text-gray-900">Contact</a>
      </div>
    </div>
  </footer>

    <!-- FAQ -->
  <section class="py-12">
    <div class="max-w-3xl mx-auto px-4">
      <h2 class="text-3xl font-extrabold">FAQ</h2>
      <div class="mt-6 space-y-4">
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">How do I get the Zoom link?</summary>
          <p class="mt-2 text-gray-700">We email it after successful payment (to the email you registered with) with date and time for your game session</p>
        </details>
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">Is payment secure?</summary>
          <p class="mt-2 text-gray-700">Yes. We never see your card details. Stripe, a PCI‑compliant provider, handles the checkout.</p>
        </details>
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">How is the winner decided?</summary>
          <p class="mt-2 text-gray-700">The host tracks scores during the game. In a tie, we run a quick tiebreaker round.</p>
        </details>
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">What is the eligibilty?</summary>
          <p class="mt-2 text-gray-700">* Participants must be at least 18 years old.</p>
          <p class="mt-2 text-gray-700">* Participants must speak and understand English.</p>
          <p class="mt-2 text-gray-700">* Participants must be Canadian resident.</p>
          <p class="mt-2 text-gray-700">* Participants must agree that their video can be uploaded to social media.</p>
        </details>
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">How are players selected?</summary>
          <p class="mt-2 text-gray-700">*Competitors are selected from the pool of applicants for each event.</p>
          <p class="mt-2 text-gray-700">* Selection involves a random draw combined with a review to ensure a fun, high-energy game.</p>
          <p class="mt-2 text-gray-700">* Selected players receive an exclusive zoom link for their game session.</p>
        </details>
        <details class="p-4 bg-white rounded-2xl shadow">
          <summary class="font-semibold">Do you have a waitlist?</summary>
          <p class="mt-2 text-gray-700">* Based on the number of game sessions we have planned ahead, we select the required number of players first and place all other players in the waitlist.</p>
          <p class="mt-2 text-gray-700">* If a selected player does not confirm their participation via email on time, the spot is offered to the next person on the waitlist.</p>
        </details>
      </div>
    </div>
  </section>

  <script>
    // Set current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Utility to calculate age from DOB string (yyyy-mm-dd)
    function calculateAge(dob) {
      const birthDate = new Date(dob);
      const today = new Date();
      let age = today.getFullYear() - birthDate.getFullYear();
      const m = today.getMonth() - birthDate.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }
      return age;
    }

    // Availability array to store selected dates
    const availability = [];

    // Map date to time slot string
    function getTimeSlot(dateStr) {
      if (dateStr === '2025-08-15') return '10-12 PM';
      if (dateStr === '2025-08-16') return '1-3 PM';
      return '';
    }

    // DOM elements
    const dateSelect = document.getElementById('dateSelect');
    const addAvailabilityBtn = document.getElementById('addAvailabilityBtn');
    const availabilityList = document.getElementById('availabilityList');
    const regForm = document.getElementById('regForm');
    const paySection = document.getElementById('pay');

    // Add availability date/time when button clicked
    addAvailabilityBtn.addEventListener('click', () => {
      const selectedDate = dateSelect.value;
      if (!selectedDate) {
        alert('Please select a date to add.');
        return;
      }
      if (availability.some(a => a.date === selectedDate)) {
        alert('You already added this date.');
        return;
      }

      availability.push({ date: selectedDate, time: getTimeSlot(selectedDate) });

      // Create a visual item in availability list
      const item = document.createElement('div');
      item.className = 'availability-item';
      item.textContent = `${new Date(selectedDate).toLocaleDateString(undefined, { weekday: 'long', year:'numeric', month:'short', day:'numeric' })} (${getTimeSlot(selectedDate)})`;
      availabilityList.appendChild(item);

      // Reset select
      dateSelect.value = '';
    });

    // On form submit validate all fields, consents, age, and availability
    regForm.addEventListener('submit', (e) => {
      e.preventDefault();

      // Required fields
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const city = document.getElementById('city').value.trim();
      const country = document.getElementById('country').value.trim();
      const dob = document.getElementById('dob').value;

      if (!name || !email || !city || !country || !dob) {
        alert('Please fill in all required fields.');
        return;
      }

      // Email format check
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailPattern.test(email)) {
        alert('Please enter a valid email address.');
        return;
      }

      // Age check
      if (calculateAge(dob) < 18) {
        alert('You must be at least 18 years old to participate.');
        return;
      }

      // Consent checks
      const requiredConsents = ['consent', 'over18', 'canadianResident', 'englishProficient', 'videoConsent'];
      for (const id of requiredConsents) {
        if (!document.getElementById(id).checked) {
          alert('Please agree to all consents to proceed.');
          return;
        }
      }

      // Availability check
      if (availability.length === 0) {
        alert('Please add at least one availability date.');
        return;
      }

      // All checks passed — show payment section and optionally scroll to it
      paySection.style.display = 'block';
      paySection.scrollIntoView({ behavior: 'smooth' });

      // Optionally: here you might disable the submit button or prevent multiple submits
      function updateSubmitButtonState() {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const city = document.getElementById('city').value.trim();
      const country = document.getElementById('country').value.trim();
      const dob = document.getElementById('dob').value;
    
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const ageValid = dob && calculateAge(dob) >= 18;
      const emailValid = emailPattern.test(email);
    
      const consentsOk = ['consent', 'over18', 'canadianResident', 'englishProficient', 'videoConsent']
        .every(id => document.getElementById(id).checked);
    
      const availabilityOk = availability.length > 0;
    
      const allGood = name && emailValid && city && country && ageValid && consentsOk && availabilityOk;
    
      const submitBtn = document.getElementById('submitBtn');
      if (allGood) {
        submitBtn.disabled = false;
        submitBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
        submitBtn.classList.add('bg-gray-900', 'cursor-pointer');
      } else {
        submitBtn.disabled = true;
        submitBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
        submitBtn.classList.remove('bg-gray-900', 'cursor-pointer');
      }
    }
    
    // Attach event listeners to inputs, checkboxes, and availability add button
    const fieldsToWatch = ['name', 'email', 'city', 'country', 'dob',
                           'consent', 'over18', 'canadianResident', 'englishProficient', 'videoConsent'];
    
    fieldsToWatch.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      el.addEventListener('input', updateSubmitButtonState);
      el.addEventListener('change', updateSubmitButtonState);
    });
    
    // Also update submit button state when availability changes
    addAvailabilityBtn.addEventListener('click', () => {
      // ... your existing code adding availability ...
    
      updateSubmitButtonState();
    });
    
    // Initialize button state on page load
    updateSubmitButtonState();      
    });
  </script>
</body>
</html>
